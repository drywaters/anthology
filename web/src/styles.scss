@use '@angular/material' as mat;
@import url('https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap');
@include mat.core();

$light-theme-config: (
    color: (
        primary: mat.$spring-green-palette,
        secondary: mat.$orange-palette,
        tertiary: mat.$violet-palette,
        theme-type: light,
    ),
    typography: (
        'Roboto',
        sans-serif,
    ),
    density: 0,
);
$dark-theme-config: (
    color: (
        primary: mat.$spring-green-palette,
        secondary: mat.$orange-palette,
        tertiary: mat.$violet-palette,
        theme-type: dark,
    ),
    typography: (
        'Roboto',
        sans-serif,
    ),
    density: 0,
);

// Compact density configurations for tighter UI
$light-theme-compact: (
    color: (
        primary: mat.$spring-green-palette,
        secondary: mat.$orange-palette,
        tertiary: mat.$violet-palette,
        theme-type: light,
    ),
    typography: (
        'Roboto',
        sans-serif,
    ),
    density: -1,
);
$dark-theme-compact: (
    color: (
        primary: mat.$spring-green-palette,
        secondary: mat.$orange-palette,
        tertiary: mat.$violet-palette,
        theme-type: dark,
    ),
    typography: (
        'Roboto',
        sans-serif,
    ),
    density: -1,
);

html {
    @include mat.theme($light-theme-config);
    @include mat.elevation-classes();

    color-scheme: light dark;
}

@media (prefers-color-scheme: dark) {
    html:not([data-theme]) {
        @include mat.theme($dark-theme-config);
    }
}

html[data-theme='light'] {
    @include mat.theme($light-theme-config);

    color-scheme: light;
}

html[data-theme='dark'] {
    @include mat.theme($dark-theme-config);

    color-scheme: dark;
}

// Compact density mode - toggled via data-density attribute
html[data-density='compact'] {
    @include mat.theme($light-theme-compact);
}

@media (prefers-color-scheme: dark) {
    html[data-density='compact']:not([data-theme]) {
        @include mat.theme($dark-theme-compact);
    }
}

html[data-theme='light'][data-density='compact'] {
    @include mat.theme($light-theme-compact);
}

html[data-theme='dark'][data-density='compact'] {
    @include mat.theme($dark-theme-compact);
}

html,
body {
    height: 100%;
}

body {
    margin: 0;
    font-family: Roboto, 'Helvetica Neue', sans-serif;
}

// =============================================================================
// APPLICATION DESIGN TOKENS
// =============================================================================
// Form field appearance pattern:
// - Primary forms (add-item, edit-item, login): appearance="fill"
// - Secondary/filter UI (filter panels): appearance="outline"
:root {
    --app-form-field-appearance: fill;
    --app-form-field-appearance-secondary: outline;
}

// =============================================================================
// COMPONENT-SPECIFIC GLOBAL OVERRIDES
// These styles target Angular Material internals that cannot be styled from
// component stylesheets due to view encapsulation. Scoped to component selectors
// to minimize global impact.
// =============================================================================

// Sidebar tab content spacing (slot-sidebar component)
// This targets mat-tab-body-content which is rendered outside component scope.
app-slot-sidebar .mat-mdc-tab-body-content {
    padding-top: 16px;
}

// Delete button in item form - uses error color for destructive action.
// Material Design 3 doesn't support color="warn" the same as M2, so we
// override directly. High specificity selector matches Material's internal styles.
app-item-form button.form-actions__delete.mat-mdc-unelevated-button:not(:disabled) {
    background-color: var(--mat-sys-error);
    color: var(--mat-sys-on-error);
}

app-item-form button.form-actions__delete.mat-mdc-unelevated-button:not(:disabled):hover {
    background-color: color-mix(in srgb, var(--mat-sys-error) 88%, var(--mat-sys-surface));
}

app-item-form button.form-actions__delete.mat-mdc-unelevated-button:disabled {
    background-color: color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent);
    color: color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent);
}

// =============================================================================
// ITEMS TABLE LAYOUT
// Material Table uses flexbox by default which doesn't support proper column
// resizing. These overrides convert to table layout with CSS custom properties
// for column widths, enabling responsive column sizing.
// =============================================================================
app-items-table-view .items-table {
    // Use native table layout for proper column sizing
    display: table;
    table-layout: fixed;

    // Column group definitions using CSS custom properties set by component
    col.col-title {
        width: var(--col-title);
        min-width: 260px;
    }

    col.col-creator {
        width: var(--col-creator);
        min-width: 200px;
    }

    col.col-itemType {
        width: var(--col-itemType);
        min-width: 140px;
    }

    col.col-releaseYear {
        width: var(--col-releaseYear);
        min-width: 90px;
    }

    col.col-updatedAt {
        width: var(--col-updatedAt);
        min-width: 150px;
    }

    // Override Material's flex rows with table rows
    .mat-mdc-header-row,
    .mat-mdc-row {
        display: table-row;
    }

    // Override Material's flex cells with table cells
    .mat-mdc-header-cell,
    .mat-mdc-cell {
        display: table-cell;
        vertical-align: top;
        white-space: normal;
        overflow-wrap: anywhere;
        word-break: break-word;
        line-height: 1.4;
    }

    // Column width assignments
    .mat-column-title {
        width: var(--col-title);
    }

    .mat-column-creator {
        width: var(--col-creator);
    }

    .mat-column-itemType {
        width: var(--col-itemType);
    }

    .mat-column-releaseYear {
        width: var(--col-releaseYear);
    }

    .mat-column-updatedAt {
        width: var(--col-updatedAt);
    }
}

// Hide less critical columns on mobile viewports
@media (width <= 680px) {
    app-items-table-view .items-table {
        col.col-releaseYear,
        col.col-updatedAt {
            display: none;
            width: 0;
            min-width: 0;
        }

        .mat-column-releaseYear,
        .mat-column-updatedAt {
            display: none;
        }
    }
}

// =============================================================================
// NOTIFICATION SNACKBAR STYLING
// Custom styling for NotificationService semantic notification types.
// Uses Material Design 3 system tokens for consistent theming.
// =============================================================================
.notification-success {
    --mdc-snackbar-container-color: var(--mat-sys-primary-container);
    --mdc-snackbar-supporting-text-color: var(--mat-sys-on-primary-container);

    .mat-mdc-button.mat-mdc-snack-bar-action {
        color: var(--mat-sys-on-primary-container);
    }
}

.notification-error {
    --mdc-snackbar-container-color: var(--mat-sys-error-container);
    --mdc-snackbar-supporting-text-color: var(--mat-sys-on-error-container);

    .mat-mdc-button.mat-mdc-snack-bar-action {
        color: var(--mat-sys-on-error-container);
    }
}

.notification-warn {
    --mdc-snackbar-container-color: color-mix(
        in srgb,
        var(--mat-sys-tertiary-container) 90%,
        var(--mat-sys-surface)
    );
    --mdc-snackbar-supporting-text-color: var(--mat-sys-on-tertiary-container);

    .mat-mdc-button.mat-mdc-snack-bar-action {
        color: var(--mat-sys-on-tertiary-container);
    }
}
