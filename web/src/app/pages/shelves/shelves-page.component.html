<div class="page">
    <div class="page__header">
        <div>
            <h1>Shelves</h1>
            <p class="subtitle">Create a visual shelf and place your anthology items by slot.</p>
        </div>
    </div>

    <mat-card class="create-card">
        <div class="create-card__header">
            <div>
                <h2>Add shelf</h2>
                <p class="helper">Provide a name and photo URL to start laying out slots.</p>
            </div>
            <button mat-stroked-button color="primary" (click)="createShelf()" [disabled]="creating()">Create shelf</button>
        </div>
        <form [formGroup]="createForm" class="create-card__form">
            <mat-form-field appearance="outline">
                <mat-label>Name</mat-label>
                <input matInput placeholder="Living Room - Main" formControlName="name" />
                <mat-error *ngIf="createForm.controls.name.invalid">A name is required</mat-error>
            </mat-form-field>
            <mat-form-field appearance="outline">
                <mat-label>Photo URL</mat-label>
                <input matInput placeholder="https://..." formControlName="photoUrl" />
                <mat-error *ngIf="createForm.controls.photoUrl.invalid">Photo URL required</mat-error>
            </mat-form-field>
            <mat-form-field appearance="outline">
                <mat-label>Description</mat-label>
                <textarea matInput rows="2" formControlName="description"></textarea>
            </mat-form-field>
        </form>
    </mat-card>

    <mat-progress-bar *ngIf="loading()" mode="indeterminate"></mat-progress-bar>

    <div class="shelf-grid" *ngIf="hasShelves(); else emptyState">
        <mat-card class="shelf-card" *ngFor="let shelf of shelves(); trackBy: trackByShelf" [routerLink]="['/shelves', shelf.shelf.id]">
            <img class="shelf-card__thumb" [src]="shelf.shelf.photoUrl" [alt]="shelf.shelf.name" />
            <div class="shelf-card__content">
                <div class="shelf-card__title">{{ shelf.shelf.name }}</div>
                <div class="shelf-card__description">{{ shelf.shelf.description || 'No description' }}</div>
                <div class="shelf-card__meta">
                    <span><mat-icon inline>grid_on</mat-icon>{{ shelf.slotCount }} slots</span>
                    <span><mat-icon inline>inventory_2</mat-icon>{{ shelf.itemCount }} items</span>
                </div>
            </div>
        </mat-card>
    </div>

    <ng-template #emptyState>
        <div class="empty">
            <mat-icon>grid_view</mat-icon>
            <p>Create your first shelf to begin placing items.</p>
        </div>
    </ng-template>
</div>
