@if (scannerActive && (scannerStatus || scannerError)) {
    <div class="scanner-feedback" aria-live="polite">
        @if (scannerStatus) {
            <div class="status">{{ scannerStatus }}</div>
        }
        @if (scannerError) {
            <div class="error">{{ scannerError }}</div>
        }
    </div>
}

<div
    class="scanner-preview"
    [class.scanner-preview--visible]="scannerActive"
    [attr.aria-hidden]="scannerActive ? 'false' : 'true'"
>
    @if (scannerActive) {
        <p class="hint">Once we read a code, we'll automatically run the lookup for you.</p>
    }
    <div class="video-frame">
        <video #scanVideo autoplay playsinline muted class="scanner-video"></video>
        @if (scannerActive && scannerReady) {
            <div class="scanner-overlay">
                <div class="scanner-frame"></div>
            </div>
        }
        @if (scannerFlash) {
            <div class="scanner-overlay scanner-overlay--flash"></div>
        }
        @if (scannerProcessing) {
            <div class="scanner-overlay scanner-overlay--busy">
                <div class="busy-indicator">
                    <mat-progress-spinner mode="indeterminate" diameter="44"></mat-progress-spinner>
                    <div class="busy-text">
                        {{ scannerStatus ?? 'Found barcode. Searching...' }}
                    </div>
                </div>
            </div>
        }
    </div>
</div>
