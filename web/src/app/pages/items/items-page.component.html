<div class="page">
    <app-items-filter-panel
        [typeFilter]="typeFilter"
        [statusFilter]="statusFilter"
        [shelfStatusFilter]="shelfStatusFilter"
        [showStatusFilter]="showStatusFilter"
        [isGridView]="isGridView"
        [typeOptions]="typeOptions"
        [statusOptions]="statusOptions"
        [shelfStatusOptions]="shelfStatusOptions"
        (typeFilterChange)="setTypeFilter($event)"
        (statusFilterChange)="setStatusFilter($event)"
        (shelfStatusFilterChange)="setShelfStatusFilter($event)"
        (viewModeChange)="setViewMode($event)"
    ></app-items-filter-panel>

    <div class="layout">
        <section class="items-panel" #scrollContainer>
            <mat-card>
                <mat-progress-bar *ngIf="loading()" mode="indeterminate"></mat-progress-bar>

                <ng-container *ngIf="hasFilteredItems(); else emptyState">
                    <app-items-grid-view
                        *ngIf="isGridView(); else tableView"
                        [groupedItems]="groupedItems"
                        (itemSelected)="startEdit($event)"
                        (shelfLocationRequested)="viewShelfPlacementFromChild($event)"
                    ></app-items-grid-view>

                    <ng-template #tableView>
                        <app-items-table-view
                            [groupedItems]="groupedItems"
                            [typeFilter]="typeFilter"
                            [displayedColumns]="displayedColumns"
                            (itemSelected)="startEdit($event)"
                            (shelfLocationRequested)="viewShelfPlacementFromChild($event)"
                            (typeFilterRequested)="filterByType($event)"
                        ></app-items-table-view>
                    </ng-template>
                </ng-container>

                <ng-template #emptyState>
                    <app-items-empty-state
                        [isUnfiltered]="isUnfiltered"
                        [loading]="loading"
                        (createRequested)="startCreate()"
                    ></app-items-empty-state>
                </ng-template>
            </mat-card>
        </section>

        <app-alpha-rail
            [histogram]="histogram"
            [activeLetter]="activeLetter"
            [style.top.px]="alphaRailTop()"
            [style.--alpha-rail-max-height]="alphaRailMaxHeight()"
            (letterSelected)="onLetterSelected($event)"
        ></app-alpha-rail>
    </div>
</div>
