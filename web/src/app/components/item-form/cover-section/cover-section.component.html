<div class="cover-section" [formGroup]="form">
    <div class="cover-preview" [class.cover-preview--empty]="!form.get('coverImage')?.value">
        @if (form.get('coverImage')?.value) {
            <img [src]="form.get('coverImage')?.value" alt="Cover preview" />
        }
        @if (!form.get('coverImage')?.value) {
            <div class="cover-placeholder">
                <mat-icon aria-hidden="true">photo</mat-icon>
                <span>No cover added yet</span>
            </div>
        }
    </div>

    <div class="cover-fields">
        <div class="cover-header">
            <h4>Cover image</h4>
            <p class="cover-hint">
                Use a JPG/PNG under 500KB. Upload a file or paste an image link.
            </p>
        </div>

        <mat-form-field appearance="fill" class="cover-image-field">
            <mat-label>Cover image URL or data URI</mat-label>
            <input matInput formControlName="coverImage" (input)="clearCoverError()" />
            @if (form.get('coverImage')?.value) {
                <button
                    mat-icon-button
                    matSuffix
                    type="button"
                    (click)="clearCoverImage()"
                    aria-label="Remove cover image"
                >
                    <mat-icon>close</mat-icon>
                </button>
            }
            <mat-hint>Links stay as-is; uploaded images are stored as thumbnails.</mat-hint>
        </mat-form-field>

        <div class="cover-actions">
            <button mat-stroked-button type="button" (click)="openCoverFilePicker()">
                Upload image
            </button>
            <button
                mat-button
                type="button"
                (click)="clearCoverImage()"
                [disabled]="!form.get('coverImage')?.value"
            >
                Remove
            </button>
            <input
                #coverInput
                type="file"
                accept="image/*"
                class="sr-only"
                (change)="handleCoverFileChange($event)"
            />
        </div>

        @if (coverImageError) {
            <div class="cover-error">{{ coverImageError }}</div>
        }
    </div>
</div>
